<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WordMark Options</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        margin: 0;
        padding: 24px;
        background: #f7f7f8;
        color: #141312;
      }
      h1 {
        font-size: 20px;
        margin: 0 0 12px;
      }
      h2 {
        font-size: 16px;
        margin: 0 0 10px;
      }
      .card {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 16px;
        max-width: 720px;
      }
      .muted {
        color: #555;
        font-size: 13px;
        line-height: 1.45;
        margin: 0 0 14px;
      }
      .field {
        display: flex;
        flex-direction: column;
        gap: 6px;
        margin: 10px 0;
      }
      .field-row {
        margin: 10px 0;
      }
      .field-inline {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      label {
        font-size: 13px;
      }
      input[type="password"],
      select {
        font-size: 13px;
        padding: 8px 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
      }
      .grid-width input[type="password"],
      .grid-width input[type="text"] {
        width: 100%;
        box-sizing: border-box;
      }
      .provider-config input[type="text"] {
        width: 100%;
        box-sizing: border-box;
      }
      :root {
        --translation-col-width: 220px;
        --definition-col-width: 220px;
        --definition-translate-col-width: 220px;
        --translation-row-gap: 16px;
        --translation-row-width: 692px;
        --note-fixed-height: 20px;
      }
      .grid-row {
        display: grid;
        grid-template-columns: var(--translation-col-width) var(--definition-col-width)
          var(--definition-translate-col-width);
        column-gap: var(--translation-row-gap);
        align-items: end;
        width: var(--translation-row-width);
      }
      .toggle-row {
        align-items: stretch;
      }
      .grid-width {
        width: var(--translation-row-width);
      }
      .toggle-box {
        background: #f9fafb;
        border: 1px solid #d1d5db;
        border-radius: 10px;
        padding: 10px 12px;
        width: 100%;
        box-sizing: border-box;
        position: relative;
        min-height: 44px;
        display: flex;
        align-items: center;
      }
      .toggle-box details {
        width: 100%;
      }
      .toggle-box details summary {
        font-weight: 600;
        font-size: 13px;
        color: #111827;
        cursor: pointer;
        list-style: none;
        display: flex;
        align-items: center;
        user-select: none;
        min-height: 24px;
      }
      .toggle-box details summary::-webkit-details-marker {
        display: none;
      }
      .toggle-box details summary::before {
        content: "▶";
        margin-right: 8px;
        font-size: 10px;
        color: #000000;
        transition: transform 0.2s;
      }
      .toggle-box details[open] summary::before {
        transform: rotate(90deg);
      }
      .toggle-box details .detail-content {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        margin-top: 4px;
        background: #ffffff;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        padding: 12px;
        z-index: 1000;
        opacity: 1;
      }
      .toggle-box details .detail-option {
        margin: 8px 0;
      }
      .toggle-box details .detail-option label {
        display: flex;
        align-items: center;
        font-weight: 400;
        font-size: 13px;
        color: #374151;
        cursor: pointer;
      }
      .toggle-box details .detail-option .label-text-accent {
        background: #fff7ed;
        border: 1px solid #fbbf24;
        border-radius: 6px;
        padding: 4px 8px;
        color: #92400e;
        font-weight: 600;
      }
      .toggle-box details .detail-option input[type="checkbox"] {
        margin-right: 8px;
      }
      .toggle-box details .detail-option .detail-hint {
        font-size: 11px;
        color: #9ca3af;
        margin-top: 0px;
        margin-left: 26px;
        line-height: 1.4;
      }
      .toggle-box label {
        display: flex;
        align-items: center;
        font-weight: 600;
        font-size: 13px;
        color: #111827;
      }
      .toggle-box-accent {
        background: #fff7ed;
        border-color: #fbbf24;
      }
      .toggle-box-accent label {
        font-weight: 700;
        color: #92400e;
      }
      .toggle-box-accent details summary {
        font-weight: 700;
        color: #92400e;
      }
      .toggle-box.is-disabled details summary {
        opacity: 0.6;
      }
      .toggle-box.is-disabled label {
        opacity: 0.6;
      }
      .row {
        display: flex;
        gap: 8px;
        margin-top: 10px;
      }
      button {
        font-size: 13px;
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
        background: #f9fafb;
        cursor: pointer;
      }
      button.primary {
        background: #111827;
        color: #ffffff;
        border-color: #111827;
      }
      .status {
        margin-top: 12px;
        font-size: 13px;
        color: #374151;
      }
      .status strong {
        font-weight: 700;
      }
      .status-on {
        color: #065f46;
      }
      .status-off {
        color: #b91c1c;
      }
      .note {
        margin-top: 10px;
        font-size: 12px;
        color: #6b7280;
        min-height: var(--note-fixed-height);
        display: flex;
        align-items: center;
        line-height: var(--note-fixed-height);
      }
      .note-pill {
        display: inline-flex;
        align-items: center;
        border-radius: 8px;
        padding: 0 8px;
        min-height: var(--note-fixed-height);
        line-height: var(--note-fixed-height);
        box-sizing: border-box;
      }
      .note-pill.note-success {
        color: #065f46;
        background: #ecfdf3;
        box-shadow: inset 0 0 0 1px #a7f3d0;
      }
      .note-pill.note-error {
        color: #b91c1c;
        background: #fef2f2;
        box-shadow: inset 0 0 0 1px #fecaca;
      }
      .segmented {
        display: inline-flex;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        overflow: hidden;
        background: #f3f4f6;
        align-self: flex-start;
        width: 100%;
      }
      .segmented button {
        border: none;
        background: transparent;
        padding: 8px 20px;
        font-size: 13px;
        cursor: pointer;
        color: #111827;
        flex: 1;
      }
      .segmented button[aria-pressed="true"] {
        background: #111827;
        color: #ffffff;
      }
      .segmented button:disabled {
        cursor: not-allowed;
        opacity: 0.6;
      }
      .direction-select {
        position: relative;
        display: flex;
        align-items: center;
        width: 100%;
      }
      .direction-select select {
        padding-right: 120px;
      }
      .select-compact {
        width: 100%;
      }
      .direction-hint {
        position: absolute;
        right: 28px;
        font-size: 12px;
        color: #6b7280;
        pointer-events: none;
        white-space: nowrap;
      }
      .provider-config {
        margin-top: 12px;
        padding: 12px;
        border: 1px dashed #e5e7eb;
        border-radius: 10px;
        background: #f8fafc;
        width: var(--translation-row-width);
        box-sizing: border-box;
      }
      .shortcut-card {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 16px;
        max-width: 720px;
        margin-bottom: 12px;
      }
      .shortcut-card h2 {
        margin: 0 0 8px;
      }
      .shortcut-actions {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-top: 8px;
      }
      .shortcut-button {
        font-size: 13px;
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid #111827;
        background: #111827;
        color: #ffffff;
        cursor: pointer;
      }
      .shortcut-button:focus-visible {
        outline: 2px solid #2563eb;
        outline-offset: 2px;
      }
    </style>
  </head>
  <body>
    <main id="app">
      <h1>WordMark Options</h1>

      <section class="shortcut-card">
        <h2>Shortcuts</h2>
        <p class="muted">
          Set a keyboard shortcut for WordMark in your browser’s shortcut settings. Then, if you plan to use translation,
          add your API key in the section below.
        </p>
        <div class="shortcut-actions">
          <button class="shortcut-button" type="button" id="shortcut-open">Go to shortcut settings</button>
        </div>
      </section>

      <section class="card">
        <h2>Translation</h2>
        <p class="muted">
          Translation is <strong>enabled by default</strong>. When enabled, WordMark will make a
          network request after you look up a word. The request
          sends only the looked-up word and (if present) the definition text.
        </p>

        <div class="field">
          <div class="toggle-row grid-row">
            <div class="toggle-box toggle-box-accent" id="translation-toggle">
              <details>
                <summary>Translation</summary>
                <div class="detail-content">
                  <div class="detail-option">
                    <label>
                      <input type="checkbox" id="translation-enabled" />
                      <span class="label-text-accent">Enable this feature</span>
                    </label>
                  </div>
                  <div class="detail-option">
                    <label>
                      <input type="checkbox" id="save-queried-words" />
                      Save queried words to list
                    </label>
                    <div class="detail-hint">Automatically add looked-up words to your word list</div>
                  </div>
                  <div class="detail-option">
                    <label>
                      <input type="checkbox" id="highlight-queried-words" />
                      Highlight queried words
                    </label>
                    <div class="detail-hint">Visually mark looked-up words on the page</div>
                  </div>
                </div>
              </details>
            </div>
            <div class="toggle-box" id="definition-backfill-toggle">
              <details>
                <summary>Same-language definition</summary>
                <div class="detail-content">
                  <div class="detail-option">
                    <label>
                      <input type="checkbox" id="definition-backfill-enabled" />
                      Enable this feature
                    </label>
                  </div>
                  <div class="detail-option">
                    <label>
                      <input type="checkbox" id="save-definition-backfill" />
                      Save results to storage
                    </label>
                    <div class="detail-hint">Saves API quota, faster lookups</div>
                  </div>
                </div>
              </details>
            </div>
            <div class="toggle-box" id="definition-translation-toggle">
              <details>
                <summary>Translate definitions</summary>
                <div class="detail-content">
                  <div class="detail-option">
                    <label>
                      <input type="checkbox" id="definition-translation-enabled" />
                      Enable this feature
                    </label>
                  </div>
                  <div class="detail-option">
                    <label>
                      <input type="checkbox" id="save-definition-translation" />
                      Save results to storage
                    </label>
                    <div class="detail-hint">Saves API quota, faster lookups</div>
                  </div>
                </div>
              </details>
            </div>
          </div>
        </div>

        <div class="field-row grid-row">
          <div class="field-inline">
            <label>Mode</label>
            <div class="segmented" role="group" aria-label="Translation mode">
              <button type="button" id="translation-mode-single" aria-pressed="true">Single</button>
              <button type="button" id="translation-mode-dual" aria-pressed="false">Dual</button>
            </div>
          </div>

          <div class="field-inline">
            <label for="translation-direction">Direction</label>
            <div class="direction-select">
              <select id="translation-direction" class="select-compact"></select>
              <span class="direction-hint" id="translation-direction-hint" hidden>查词自动识别语言</span>
            </div>
          </div>
          <div class="field-inline">
            <label for="translation-provider">Provider</label>
            <select id="translation-provider" class="select-compact">
              <option value="gemini">Gemini</option>
              <option value="deepseek">DeepSeek</option>
              <option value="moonshot">Moonshot</option>
              <option value="openai">OpenAI</option>
              <option value="qwen">Qwen</option>
              <option value="volcengine">Volcengine</option>
              <option value="zhipu">Zhipu</option>
            </select>
          </div>
        </div>

        <div id="gemini-config" class="provider-config" hidden>
          <div class="field">
            <label for="gemini-endpoint">Gemini base endpoint URL</label>
            <input
              id="gemini-endpoint"
              type="text"
              autocomplete="off"
              placeholder="https://generativelanguage.googleapis.com/v1beta"
            />
          </div>

          <div class="field">
            <label for="gemini-model">Gemini model ID</label>
            <input id="gemini-model" type="text" autocomplete="off" placeholder="gemini-2.5-flash" />
          </div>

          <div class="row">
            <button class="primary" type="button" id="gemini-save">Save Gemini config</button>
            <button type="button" id="gemini-clear">Clear Gemini config</button>
          </div>

          <div class="note" id="gemini-note">
            Gemini configuration is optional. It applies only when both fields are set; otherwise WordMark uses the built-in endpoints and automatic model selection. Endpoint URLs must be HTTPS.
          </div>
        </div>

        <div id="deepseek-config" class="provider-config" hidden>
          <div class="field">
            <label for="deepseek-endpoint">DeepSeek endpoint URL</label>
            <input
              id="deepseek-endpoint"
              type="text"
              autocomplete="off"
              placeholder="https://api.deepseek.com/chat/completions"
            />
          </div>

          <div class="field">
            <label for="deepseek-model">DeepSeek model ID</label>
            <input id="deepseek-model" type="text" autocomplete="off" placeholder="deepseek-chat" />
          </div>

          <div class="row">
            <button class="primary" type="button" id="deepseek-save">Save DeepSeek config</button>
            <button type="button" id="deepseek-clear">Clear DeepSeek config</button>
          </div>

          <div class="note" id="deepseek-note">DeepSeek configuration is required only when DeepSeek is selected. Endpoint URLs must be HTTPS.</div>
        </div>

        <div id="moonshot-config" class="provider-config" hidden>
          <div class="field">
            <label for="moonshot-endpoint">Moonshot endpoint URL</label>
            <input
              id="moonshot-endpoint"
              type="text"
              autocomplete="off"
              placeholder="https://api.moonshot.cn/v1/chat/completions"
            />
          </div>

          <div class="field">
            <label for="moonshot-model">Moonshot model ID</label>
            <input id="moonshot-model" type="text" autocomplete="off" placeholder="Enter model ID" />
          </div>

          <div class="row">
            <button class="primary" type="button" id="moonshot-save">Save Moonshot config</button>
            <button type="button" id="moonshot-clear">Clear Moonshot config</button>
          </div>

          <div class="note" id="moonshot-note">
            Moonshot configuration is required only when Moonshot is selected. Endpoint URLs must be HTTPS.
          </div>
        </div>

        <div id="openai-config" class="provider-config" hidden>
          <div class="field">
            <label for="openai-endpoint">OpenAI endpoint URL</label>
            <input
              id="openai-endpoint"
              type="text"
              autocomplete="off"
              placeholder="https://api.openai.com/v1/chat/completions"
            />
          </div>

          <div class="field">
            <label for="openai-model">OpenAI model ID</label>
            <input id="openai-model" type="text" autocomplete="off" placeholder="Enter model ID" />
          </div>

          <div class="row">
            <button class="primary" type="button" id="openai-save">Save OpenAI config</button>
            <button type="button" id="openai-clear">Clear OpenAI config</button>
          </div>

          <div class="note" id="openai-note">OpenAI configuration is required only when OpenAI is selected.</div>
        </div>

        <div id="qwen-config" class="provider-config" hidden>
          <div class="field">
            <label for="qwen-endpoint">Qwen endpoint URL</label>
            <input
              id="qwen-endpoint"
              type="text"
              autocomplete="off"
              placeholder="https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions"
            />
          </div>

          <div class="field">
            <label for="qwen-model">Qwen model ID</label>
            <input id="qwen-model" type="text" autocomplete="off" placeholder="qwen-plus" />
          </div>

          <div class="row">
            <button class="primary" type="button" id="qwen-save">Save Qwen config</button>
            <button type="button" id="qwen-clear">Clear Qwen config</button>
          </div>

          <div class="note" id="qwen-note">Qwen configuration is required only when Qwen is selected.</div>
        </div>

        <div id="volcengine-config" class="provider-config" hidden>
          <div class="field">
            <label for="volcengine-endpoint">Volcengine endpoint URL</label>
            <input
              id="volcengine-endpoint"
              type="text"
              autocomplete="off"
              placeholder="https://ark.cn-beijing.volces.com/api/v3/chat/completions"
            />
          </div>

          <div class="field">
            <label for="volcengine-model">Volcengine model/endpoint ID</label>
            <input id="volcengine-model" type="text" autocomplete="off" placeholder="Enter model or endpoint ID" />
          </div>

          <div class="row">
            <button class="primary" type="button" id="volcengine-save">Save Volcengine config</button>
            <button type="button" id="volcengine-clear">Clear Volcengine config</button>
          </div>

          <div class="note" id="volcengine-note">Volcengine configuration is required only when Volcengine is selected.</div>
        </div>

        <div id="zhipu-config" class="provider-config" hidden>
          <div class="field">
            <label for="zhipu-endpoint">Zhipu endpoint URL</label>
            <input
              id="zhipu-endpoint"
              type="text"
              autocomplete="off"
              placeholder="https://open.bigmodel.cn/api/paas/v4/chat/completions"
            />
          </div>

          <div class="field">
            <label for="zhipu-model">Zhipu model ID</label>
            <input id="zhipu-model" type="text" autocomplete="off" placeholder="Enter model ID" />
          </div>

          <div class="row">
            <button class="primary" type="button" id="zhipu-save">Save Zhipu config</button>
            <button type="button" id="zhipu-clear">Clear Zhipu config</button>
          </div>

          <div class="note" id="zhipu-note">Zhipu configuration is required only when Zhipu is selected.</div>
        </div>

        <div class="field grid-width">
          <label for="translation-api-key">API key</label>
          <input
            id="translation-api-key"
            type="password"
            autocomplete="off"
            placeholder="Enter API key (stored locally)"
          />
        </div>

        <div class="row">
          <button class="primary" type="button" id="translation-save">Save API key</button>
          <button type="button" id="translation-clear">Clear API key</button>
        </div>

        <div id="translation-status" class="status" role="status" aria-live="polite"></div>
        <div class="note" id="translation-api-note">API key is stored locally and never displayed back in full.</div>
      </section>
    </main>
    <script src="options.js"></script>
  </body>
</html>
